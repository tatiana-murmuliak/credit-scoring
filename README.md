# Модель кредитного риск-менеджмента

**Задача проекта:** оценить риск неуплаты клиента по кредиту (дефолт).

Дефолт — неуплата процентов по кредиту или облигациям, непогашение займа в течение определённого времени t. Обычно дефолт считают свершившимся, если клиент не совершил выплату по кредиту в течение 90 дней. Нужная модель позволяет банку или другой кредитной организации оценить текущий риск по любым выданным займам и кредитным продуктам и с большей долей вероятности предотвратить неисполнение кредитных обязательств клиентом. Таким образом, банк меньше рискует понести убытки.

Исходные данные, используемые в данном проекте, содержат информацию о различных атрибутах заёмщиков и кредитных продуктов: о клиентах, которые уже имеют кредиты, их кредитной истории и финансовых показателях. Каждая запись в датасете представляет один конкретный кредитный продукт, выданный конкретному заёмщику.

**Целевая метрика:** `ROC-AUC` не менее 0.75 на тестовом датасете.

**Формат предсказания модели:** 1 - произошёл дефолт по кредиту, 0 - нет дефолта. 

## Структура проекта
* `Credit scoring model.ipynb` - ноутбук со сборкой датасета, анализом и обработкой данных и последующим моделированием.
* `requirements.txt` - необходимые библиотеки для выполнения проекта.
* `pipeline.py` - пайплайн с обучением модели и её сериализацией.
* `credit_scoring_pipe.pkl` - сериализованный файл с обученной моделью.
* `predictions.csv` - файл с предсказаниями модели на тестовой выборке.
Так же в корне проекта находится папка `data`, содержащая parquet-файлы вида `train_data_[0-12].pq` с исходными данными для анализа и файл `train_target.csv` с целевой переменной.

## Ход работы
В ходе выполнения проекта данные были собраны из исходных файлов в единый датасет, закодированы, сгруппированы по id (идентификатору заявки) с суммой в качестве агрегированных значений, переведены в тип int8 для экономии памяти и смёрджены с целевой переменной. Были сгенерированы новые фичи `is_zero_loans` и `is_zero_overlimit`, показывающие отсутствие или наличие просрочек и задолженностей. Итоговый датасет содержит 3000000 записей.
На этапе моделирования тренировочная выборка была сбалансирована методом даунсэмплинга. Модели машинного обучения оценивали по ROC-AUC с помощью кросс-валидации. Были исследованы следующие модели:

* RandomForestClassifier
* LogisticRegression
* GradientBoostingClassifier
* CatBoostClassifier
* XGBClassifier
* LGBMClassifier

По результатам исследования модель CatBoostClassifier показала наилучшее значение метрики, а с помощью подбора гиперпараметров удалось его ещё немного повысить.

**Итоговые значения ROC-AUC:** 0.80 на тренировочной выборке и 0.75 на тестовой.

Модель проверена на переобучение. Пайплайн с моделью записан в pickle-файл.
